---

title: Target DQN


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/20c_qlearning.dqn_target.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/20c_qlearning.dqn_target.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/envs/fastrl/lib/python3.7/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729047590/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TargetDQNTrainer" class="doc_header"><code>class</code> <code>TargetDQNTrainer</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/qlearning/dqn_target.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TargetDQNTrainer</code>(<strong><code>n_batch</code></strong>=<em><code>0</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TargetDQNLearner" class="doc_header"><code>class</code> <code>TargetDQNLearner</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/qlearning/dqn_target.py#L72" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TargetDQNLearner</code>(<strong><code>dls</code></strong>, <strong><code>agent</code></strong>:<a href="/fast-reinforcement-learning-2/basic_agents.html#BaseAgent"><code>BaseAgent</code></a>=<em><code>BaseAgent(model=None)</code></em>, <strong><code>model</code></strong>=<em><code>None</code></em>, <strong><code>use_train_mets</code></strong>=<em><code>True</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <a href="/fast-reinforcement-learning-2/learner.html#AgentLearner"><code>AgentLearner</code></a></p>
</blockquote>
<p>Base Learner for all reinforcement learning agents</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span>
<span class="n">model</span><span class="o">=</span><span class="n">LinearDQN</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span><span class="mi">2</span><span class="p">)</span>
<span class="n">agent</span><span class="o">=</span><span class="n">DiscreteAgent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">default_device</span><span class="p">()),</span><span class="n">device</span><span class="o">=</span><span class="n">default_device</span><span class="p">(),</span>
                    <span class="n">a_selector</span><span class="o">=</span><span class="n">EpsilonGreedyActionSelector</span><span class="p">())</span>

<span class="n">block</span><span class="o">=</span><span class="n">FirstLastExperienceBlock</span><span class="p">(</span><span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">dls_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bs&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;num_workers&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;verbose&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;indexed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;shuffle_train&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
<span class="n">blk</span><span class="o">=</span><span class="n">IterableDataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="p">(</span><span class="n">block</span><span class="p">),</span>
                      <span class="n">splitter</span><span class="o">=</span><span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="kc">False</span><span class="p">),</span>
                     <span class="p">)</span>
<span class="n">dls</span><span class="o">=</span><span class="n">blk</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">env</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="n">default_device</span><span class="p">())</span>

<span class="n">learner</span><span class="o">=</span><span class="n">TargetDQNLearner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">EpsilonTracker</span><span class="p">(</span><span class="n">e_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
                                        <span class="n">ExperienceReplay</span><span class="p">(</span><span class="n">sz</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">starting_els</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">max_steps</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="o">.</span><span class="n">_max_episode_steps</span><span class="p">),</span>
                                        <span class="n">TargetDQNTrainer</span><span class="p">],</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">AvgEpisodeRewardMetric</span><span class="p">(</span><span class="n">experience_cls</span><span class="o">=</span><span class="n">ExperienceFirstLast</span><span class="p">,</span><span class="n">always_extend</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">47</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span><span class="n">wd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_avg_episode_r</th>
      <th>valid_loss</th>
      <th>valid_avg_episode_r</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.523472</td>
      <td>10.336842</td>
      <td>None</td>
      <td>10.336842</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.146026</td>
      <td>11.150000</td>
      <td>None</td>
      <td>11.150000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.486364</td>
      <td>12.980000</td>
      <td>None</td>
      <td>12.980000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3.273238</td>
      <td>11.550000</td>
      <td>None</td>
      <td>11.550000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3.176242</td>
      <td>19.370000</td>
      <td>None</td>
      <td>19.370000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>5</td>
      <td>3.657235</td>
      <td>25.840000</td>
      <td>None</td>
      <td>25.840000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>6</td>
      <td>3.982712</td>
      <td>33.010000</td>
      <td>None</td>
      <td>33.010000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>7</td>
      <td>6.177357</td>
      <td>40.390000</td>
      <td>None</td>
      <td>40.390000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>8</td>
      <td>5.508453</td>
      <td>47.190000</td>
      <td>None</td>
      <td>47.190000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>9</td>
      <td>7.158568</td>
      <td>50.640000</td>
      <td>None</td>
      <td>50.640000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>10</td>
      <td>7.217332</td>
      <td>50.760000</td>
      <td>None</td>
      <td>50.760000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>11</td>
      <td>7.204279</td>
      <td>55.480000</td>
      <td>None</td>
      <td>55.480000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>12</td>
      <td>6.819917</td>
      <td>59.640000</td>
      <td>None</td>
      <td>59.640000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>13</td>
      <td>12.672626</td>
      <td>63.390000</td>
      <td>None</td>
      <td>63.390000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>14</td>
      <td>10.303137</td>
      <td>68.120000</td>
      <td>None</td>
      <td>68.120000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>15</td>
      <td>7.772073</td>
      <td>69.710000</td>
      <td>None</td>
      <td>69.710000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>16</td>
      <td>9.479779</td>
      <td>75.110000</td>
      <td>None</td>
      <td>75.110000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>17</td>
      <td>11.973249</td>
      <td>80.410000</td>
      <td>None</td>
      <td>80.410000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>18</td>
      <td>12.530799</td>
      <td>85.920000</td>
      <td>None</td>
      <td>85.920000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>19</td>
      <td>8.810143</td>
      <td>89.290000</td>
      <td>None</td>
      <td>89.290000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>20</td>
      <td>9.069714</td>
      <td>93.310000</td>
      <td>None</td>
      <td>93.310000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>21</td>
      <td>12.742575</td>
      <td>98.790000</td>
      <td>None</td>
      <td>98.790000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>22</td>
      <td>10.033114</td>
      <td>104.750000</td>
      <td>None</td>
      <td>104.750000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>23</td>
      <td>10.401029</td>
      <td>109.600000</td>
      <td>None</td>
      <td>109.600000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>24</td>
      <td>8.648491</td>
      <td>113.950000</td>
      <td>None</td>
      <td>113.950000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>25</td>
      <td>11.571786</td>
      <td>117.850000</td>
      <td>None</td>
      <td>117.850000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>26</td>
      <td>13.890467</td>
      <td>121.490000</td>
      <td>None</td>
      <td>121.490000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>27</td>
      <td>8.173745</td>
      <td>124.710000</td>
      <td>None</td>
      <td>124.710000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>28</td>
      <td>11.859429</td>
      <td>127.610000</td>
      <td>None</td>
      <td>127.610000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>29</td>
      <td>12.959861</td>
      <td>132.290000</td>
      <td>None</td>
      <td>132.290000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>30</td>
      <td>17.177937</td>
      <td>136.850000</td>
      <td>None</td>
      <td>136.850000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>31</td>
      <td>14.110768</td>
      <td>138.580000</td>
      <td>None</td>
      <td>138.580000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>32</td>
      <td>15.866390</td>
      <td>142.230000</td>
      <td>None</td>
      <td>142.230000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>33</td>
      <td>13.003003</td>
      <td>145.940000</td>
      <td>None</td>
      <td>145.940000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>34</td>
      <td>16.497839</td>
      <td>149.710000</td>
      <td>None</td>
      <td>149.710000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>35</td>
      <td>10.231419</td>
      <td>154.030000</td>
      <td>None</td>
      <td>154.030000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>36</td>
      <td>16.603588</td>
      <td>159.080000</td>
      <td>None</td>
      <td>159.080000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>37</td>
      <td>14.948006</td>
      <td>162.970000</td>
      <td>None</td>
      <td>162.970000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>38</td>
      <td>13.093913</td>
      <td>168.460000</td>
      <td>None</td>
      <td>168.460000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>39</td>
      <td>14.792350</td>
      <td>171.970000</td>
      <td>None</td>
      <td>171.970000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>40</td>
      <td>9.642009</td>
      <td>173.660000</td>
      <td>None</td>
      <td>173.660000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>41</td>
      <td>20.312279</td>
      <td>177.320000</td>
      <td>None</td>
      <td>177.320000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>42</td>
      <td>19.236807</td>
      <td>183.000000</td>
      <td>None</td>
      <td>183.000000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>43</td>
      <td>13.539074</td>
      <td>185.310000</td>
      <td>None</td>
      <td>185.310000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>44</td>
      <td>11.923749</td>
      <td>187.840000</td>
      <td>None</td>
      <td>187.840000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>45</td>
      <td>20.963083</td>
      <td>190.700000</td>
      <td>None</td>
      <td>190.700000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>46</td>
      <td>15.574746</td>
      <td>195.140000</td>
      <td>None</td>
      <td>195.140000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>47</td>
      <td>18.120064</td>
      <td>197.730000</td>
      <td>None</td>
      <td>197.730000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>48</td>
      <td>14.812123</td>
      <td>200.270000</td>
      <td>None</td>
      <td>200.270000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>49</td>
      <td>13.574879</td>
      <td>203.540000</td>
      <td>None</td>
      <td>203.540000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>50</td>
      <td>13.728050</td>
      <td>205.400000</td>
      <td>None</td>
      <td>205.400000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>51</td>
      <td>20.436741</td>
      <td>206.490000</td>
      <td>None</td>
      <td>206.490000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>52</td>
      <td>12.857967</td>
      <td>209.340000</td>
      <td>None</td>
      <td>209.340000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>53</td>
      <td>14.623627</td>
      <td>212.620000</td>
      <td>None</td>
      <td>212.620000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>54</td>
      <td>11.184551</td>
      <td>213.590000</td>
      <td>None</td>
      <td>213.590000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>55</td>
      <td>11.309648</td>
      <td>216.480000</td>
      <td>None</td>
      <td>216.480000</td>
      <td>00:11</td>
    </tr>
    <tr>
      <td>56</td>
      <td>13.795097</td>
      <td>219.720000</td>
      <td>00:11</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastprogress/fastprogress.py:74: UserWarning: Your generator is empty.
  warn(&#34;Your generator is empty.&#34;)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-5-1cfbb5f90e7c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>                                         ExperienceReplay<span class="ansi-blue-fg">(</span>sz<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100000</span><span class="ansi-blue-fg">,</span>bs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">,</span>starting_els<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">,</span>max_steps<span class="ansi-blue-fg">=</span>gym<span class="ansi-blue-fg">.</span>make<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>_max_episode_steps<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>                                         TargetDQNTrainer],metrics=[AvgEpisodeRewardMetric(experience_cls=ExperienceFirstLast,always_extend=True)])
<span class="ansi-green-fg">---&gt; 15</span><span class="ansi-red-fg"> </span>learner<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">70</span><span class="ansi-blue-fg">,</span>lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.0001</span><span class="ansi-blue-fg">,</span>wd<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    203</span>             self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>set_hypers<span class="ansi-blue-fg">(</span>lr<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>lr <span class="ansi-green-fg">if</span> lr <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> lr<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    204</span>             self<span class="ansi-blue-fg">.</span>n_epoch <span class="ansi-blue-fg">=</span> n_epoch
<span class="ansi-green-fg">--&gt; 205</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_fit<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;fit&#39;</span><span class="ansi-blue-fg">,</span> CancelFitException<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>_end_cleanup<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span> 
<span class="ansi-green-intense-fg ansi-bold">    207</span>     <span class="ansi-green-fg">def</span> _end_cleanup<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">None</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>       self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>       <span class="ansi-blue-fg">;</span>f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>        <span class="ansi-blue-fg">;</span>final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_fit</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    194</span>         <span class="ansi-green-fg">for</span> epoch <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>n_epoch<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span>             self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch
<span class="ansi-green-fg">--&gt; 196</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_epoch<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;epoch&#39;</span><span class="ansi-blue-fg">,</span> CancelEpochException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    197</span> 
<span class="ansi-green-intense-fg ansi-bold">    198</span>     <span class="ansi-green-fg">def</span> fit<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> n_epoch<span class="ansi-blue-fg">,</span> lr<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reset_opt<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>       self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>       <span class="ansi-blue-fg">;</span>f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>        <span class="ansi-blue-fg">;</span>final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    188</span> 
<span class="ansi-green-intense-fg ansi-bold">    189</span>     <span class="ansi-green-fg">def</span> _do_epoch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 190</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span>         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    192</span> 

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     <span class="ansi-green-fg">def</span> _do_epoch_train<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    181</span>         self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>train
<span class="ansi-green-fg">--&gt; 182</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;train&#39;</span><span class="ansi-blue-fg">,</span> CancelTrainException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    183</span> 
<span class="ansi-green-intense-fg ansi-bold">    184</span>     <span class="ansi-green-fg">def</span> _do_epoch_validate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> ds_idx<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> dl<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>       self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>       <span class="ansi-blue-fg">;</span>f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>        <span class="ansi-blue-fg">;</span>final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    159</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 160</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    161</span> 
<span class="ansi-green-intense-fg ansi-bold">    162</span>     <span class="ansi-green-fg">def</span> _do_one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span>         self<span class="ansi-blue-fg">.</span>iter <span class="ansi-blue-fg">=</span> i
<span class="ansi-green-intense-fg ansi-bold">    177</span>         self<span class="ansi-blue-fg">.</span>_split<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 178</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_one_batch<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;batch&#39;</span><span class="ansi-blue-fg">,</span> CancelBatchException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    179</span> 
<span class="ansi-green-intense-fg ansi-bold">    180</span>     <span class="ansi-green-fg">def</span> _do_epoch_train<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>       self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>       <span class="ansi-blue-fg">;</span>f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>        <span class="ansi-blue-fg">;</span>final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span>     <span class="ansi-green-fg">def</span> ordered_cbs<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>cb <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">,</span> event<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> 
<span class="ansi-green-fg">--&gt; 132</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> L<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_call_one<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    133</span> 
<span class="ansi-green-intense-fg ansi-bold">    134</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">map</span><span class="ansi-blue-fg">(self, f, gen, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>     <span class="ansi-green-fg">def</span> range<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span>range_of<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">=</span>b<span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">=</span>step<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span> 
<span class="ansi-green-fg">--&gt; 179</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>map_ex<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span>gen<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    180</span>     <span class="ansi-green-fg">def</span> argwhere<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>argwhere<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    181</span>     <span class="ansi-green-fg">def</span> filter<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastcore/basics.py</span> in <span class="ansi-cyan-fg">map_ex</span><span class="ansi-blue-fg">(iterable, f, gen, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    605</span>     res <span class="ansi-blue-fg">=</span> map<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">,</span> iterable<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    606</span>     <span class="ansi-green-fg">if</span> gen<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> res
<span class="ansi-green-fg">--&gt; 607</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    608</span> 
<span class="ansi-green-intense-fg ansi-bold">    609</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastcore/basics.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    595</span>             <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">,</span>_Arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> args<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span>         fargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>args<span class="ansi-blue-fg">[</span>x<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> _Arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>pargs<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>maxi<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 597</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>fargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    598</span> 
<span class="ansi-green-intense-fg ansi-bold">    599</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_call_one</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    134</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    135</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> event_name
<span class="ansi-green-fg">--&gt; 136</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    137</span> 
<span class="ansi-green-intense-fg ansi-bold">    138</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> norm_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    134</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    135</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> event_name
<span class="ansi-green-fg">--&gt; 136</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    137</span> 
<span class="ansi-green-intense-fg ansi-bold">    138</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> norm_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/fastai/callback/core.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>                (self.run_valid and not getattr(self, &#39;training&#39;, False)))
<span class="ansi-green-intense-fg ansi-bold">     43</span>         res <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">---&gt; 44</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>run <span class="ansi-green-fg">and</span> _run<span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">,</span> noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>         <span class="ansi-green-fg">if</span> event_name<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#39;after_fit&#39;</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span> <span class="ansi-red-fg">#Reset self.run to True at each end of fit</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">/opt/project/fastrl/fastrl/qlearning/dqn.py</span> in <span class="ansi-cyan-fg">before_batch</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     71</span>         <span class="ansi-green-fg">for</span> _b <span class="ansi-green-fg">in</span> batch<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>_b<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     72</span>         idxs<span class="ansi-blue-fg">=</span>np<span class="ansi-blue-fg">.</span>random<span class="ansi-blue-fg">.</span>randint<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>bs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 73</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">.</span>sample_yb<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>deepcopy<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> i <span class="ansi-green-fg">in</span> idxs<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     74</span> 
<span class="ansi-green-intense-fg ansi-bold">     75</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/project/fastrl/fastrl/qlearning/dqn.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     71</span>         <span class="ansi-green-fg">for</span> _b <span class="ansi-green-fg">in</span> batch<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>_b<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     72</span>         idxs<span class="ansi-blue-fg">=</span>np<span class="ansi-blue-fg">.</span>random<span class="ansi-blue-fg">.</span>randint<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>bs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 73</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">.</span>sample_yb<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>deepcopy<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>queue<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> i <span class="ansi-green-fg">in</span> idxs<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     74</span> 
<span class="ansi-green-intense-fg ansi-bold">     75</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/copy.py</span> in <span class="ansi-cyan-fg">deepcopy</span><span class="ansi-blue-fg">(x, memo, _nil)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span>                     y <span class="ansi-blue-fg">=</span> x
<span class="ansi-green-intense-fg ansi-bold">    179</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 180</span><span class="ansi-red-fg">                     </span>y <span class="ansi-blue-fg">=</span> _reconstruct<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> memo<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>rv<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    181</span> 
<span class="ansi-green-intense-fg ansi-bold">    182</span>     <span class="ansi-red-fg"># If is its own copy, don&#39;t memoize.</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/copy.py</span> in <span class="ansi-cyan-fg">_reconstruct</span><span class="ansi-blue-fg">(x, memo, func, args, state, listiter, dictiter, deepcopy)</span>
<span class="ansi-green-intense-fg ansi-bold">    273</span>     <span class="ansi-green-fg">if</span> deep <span class="ansi-green-fg">and</span> args<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    274</span>         args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>deepcopy<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">,</span> memo<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> arg <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 275</span><span class="ansi-red-fg">     </span>y <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    276</span>     <span class="ansi-green-fg">if</span> deep<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    277</span>         memo<span class="ansi-blue-fg">[</span>id<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> y

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/copy.py</span> in <span class="ansi-cyan-fg">&lt;genexpr&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    272</span>     deep <span class="ansi-blue-fg">=</span> memo <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">    273</span>     <span class="ansi-green-fg">if</span> deep <span class="ansi-green-fg">and</span> args<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 274</span><span class="ansi-red-fg">         </span>args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>deepcopy<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">,</span> memo<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> arg <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    275</span>     y <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    276</span>     <span class="ansi-green-fg">if</span> deep<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/copy.py</span> in <span class="ansi-cyan-fg">deepcopy</span><span class="ansi-blue-fg">(x, memo, _nil)</span>
<span class="ansi-green-intense-fg ansi-bold">    159</span>             copier <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;__deepcopy__&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    160</span>             <span class="ansi-green-fg">if</span> copier<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 161</span><span class="ansi-red-fg">                 </span>y <span class="ansi-blue-fg">=</span> copier<span class="ansi-blue-fg">(</span>memo<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    163</span>                 reductor <span class="ansi-blue-fg">=</span> dispatch_table<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/torch/tensor.py</span> in <span class="ansi-cyan-fg">__deepcopy__</span><span class="ansi-blue-fg">(self, memo)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>                 new_tensor <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>clone<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 55</span><span class="ansi-red-fg">                 </span>new_storage <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>storage<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__deepcopy__<span class="ansi-blue-fg">(</span>memo<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     56</span>                 <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>is_quantized<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span>                     <span class="ansi-red-fg"># quantizer_params can be different type based on torch attribute</span>

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/torch/storage.py</span> in <span class="ansi-cyan-fg">__deepcopy__</span><span class="ansi-blue-fg">(self, memo)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_cdata <span class="ansi-green-fg">in</span> memo<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>             <span class="ansi-green-fg">return</span> memo<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>_cdata<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">---&gt; 28</span><span class="ansi-red-fg">         </span>new_storage <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>clone<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     29</span>         memo<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>_cdata<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> new_storage
<span class="ansi-green-intense-fg ansi-bold">     30</span>         <span class="ansi-green-fg">return</span> new_storage

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/torch/storage.py</span> in <span class="ansi-cyan-fg">clone</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     41</span>         <span class="ansi-blue-fg">&#34;&#34;&#34;Returns a copy of this storage&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>         device <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>get_device<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>is_cuda <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span>
<span class="ansi-green-fg">---&gt; 43</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">with</span> torch<span class="ansi-blue-fg">.</span>cuda<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">(</span>device<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>             <span class="ansi-green-fg">return</span> type<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>copy_<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span> 

<span class="ansi-green-fg">/opt/conda/envs/fastrl/lib/python3.7/site-packages/torch/cuda/__init__.py</span> in <span class="ansi-cyan-fg">__enter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>         self<span class="ansi-blue-fg">.</span>prev_idx <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span> 
<span class="ansi-green-fg">--&gt; 222</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __enter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    223</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>idx <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span>             <span class="ansi-green-fg">return</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

