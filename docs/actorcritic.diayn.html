---

title: DIAYN


keywords: fastai
sidebar: home_sidebar

summary: "Diversity Is All You Need"
description: "Diversity Is All You Need"
nb_path: "nbs/14b_actorcritic.diayn.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/14b_actorcritic.diayn.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_LAUNCH_BLOCKING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modules">Modules<a class="anchor-link" href="#Modules"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">=</span><span class="s1">&#39;Pendulum-v0&#39;</span>
<span class="n">agent</span><span class="o">=</span><span class="n">SAC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">block</span><span class="o">=</span><span class="n">FirstLastExperienceBlock</span><span class="p">(</span><span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">exclude_nones</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">dls_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bs&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;num_workers&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;verbose&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;indexed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;shuffle_train&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
<span class="n">blk</span><span class="o">=</span><span class="n">IterableDataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="p">(</span><span class="n">block</span><span class="p">),</span>
                      <span class="n">splitter</span><span class="o">=</span><span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="kc">False</span><span class="p">),</span>
<span class="c1">#                       batch_tfms=lambda x:(x[&#39;s&#39;],x),</span>
                     <span class="p">)</span>
<span class="n">dls</span><span class="o">=</span><span class="n">blk</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">env</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="n">default_device</span><span class="p">())</span>

<span class="n">learner</span><span class="o">=</span><span class="n">SACLearner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">ExperienceReplay</span><span class="p">(</span><span class="n">sz</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="n">starting_els</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">max_steps</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="o">.</span><span class="n">_max_episode_steps</span><span class="p">),</span><span class="n">SACCriticTrainer</span><span class="p">],</span>
                   <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">AvgEpisodeRewardMetric</span><span class="p">(</span><span class="n">experience_cls</span><span class="o">=</span><span class="n">ExperienceFirstLast</span><span class="p">)])</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">wd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_avg_episode_r</th>
      <th>valid_loss</th>
      <th>valid_avg_episode_r</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>68.240349</td>
      <td>-1428.730126</td>
      <td>None</td>
      <td>-1428.730126</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>140.679016</td>
      <td>-1573.647103</td>
      <td>None</td>
      <td>-1573.647103</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>2</td>
      <td>230.889587</td>
      <td>-1502.739255</td>
      <td>None</td>
      <td>-1502.739255</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>3</td>
      <td>333.508118</td>
      <td>-1456.170725</td>
      <td>None</td>
      <td>-1456.170725</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>4</td>
      <td>343.003479</td>
      <td>-1406.864173</td>
      <td>None</td>
      <td>-1406.864173</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>5</td>
      <td>375.362946</td>
      <td>-1375.714182</td>
      <td>None</td>
      <td>-1375.714182</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>6</td>
      <td>407.716522</td>
      <td>-1340.233665</td>
      <td>None</td>
      <td>-1340.233665</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>7</td>
      <td>443.068268</td>
      <td>-1291.501812</td>
      <td>None</td>
      <td>-1291.501812</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>8</td>
      <td>473.301788</td>
      <td>-1249.785071</td>
      <td>None</td>
      <td>-1249.785071</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>9</td>
      <td>494.265442</td>
      <td>-1215.713414</td>
      <td>None</td>
      <td>-1215.713414</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>10</td>
      <td>511.766785</td>
      <td>-1186.256749</td>
      <td>None</td>
      <td>-1186.256749</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>11</td>
      <td>527.710327</td>
      <td>-1159.142336</td>
      <td>None</td>
      <td>-1159.142336</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>12</td>
      <td>540.827209</td>
      <td>-1129.974928</td>
      <td>None</td>
      <td>-1129.974928</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>13</td>
      <td>549.209229</td>
      <td>-1100.512593</td>
      <td>None</td>
      <td>-1100.512593</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>14</td>
      <td>556.626770</td>
      <td>-1073.270354</td>
      <td>None</td>
      <td>-1073.270354</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>15</td>
      <td>562.379822</td>
      <td>-1044.470044</td>
      <td>None</td>
      <td>-1044.470044</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>16</td>
      <td>565.655945</td>
      <td>-1020.647816</td>
      <td>None</td>
      <td>-1020.647816</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>17</td>
      <td>569.046692</td>
      <td>-982.388361</td>
      <td>None</td>
      <td>-982.388361</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>18</td>
      <td>566.258362</td>
      <td>-946.494682</td>
      <td>None</td>
      <td>-946.494682</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>19</td>
      <td>569.683594</td>
      <td>-914.161615</td>
      <td>None</td>
      <td>-914.161615</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>20</td>
      <td>567.219421</td>
      <td>-884.919657</td>
      <td>None</td>
      <td>-884.919657</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>21</td>
      <td>565.771423</td>
      <td>-858.335929</td>
      <td>None</td>
      <td>-858.335929</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>22</td>
      <td>557.913391</td>
      <td>-833.975748</td>
      <td>None</td>
      <td>-833.975748</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>23</td>
      <td>546.038208</td>
      <td>-811.668171</td>
      <td>None</td>
      <td>-811.668171</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>24</td>
      <td>536.706848</td>
      <td>-799.062749</td>
      <td>None</td>
      <td>-799.062749</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>25</td>
      <td>516.377258</td>
      <td>-739.399314</td>
      <td>None</td>
      <td>-739.399314</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>26</td>
      <td>504.254395</td>
      <td>-681.000106</td>
      <td>None</td>
      <td>-681.000106</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>27</td>
      <td>488.861206</td>
      <td>-638.974667</td>
      <td>None</td>
      <td>-638.974667</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>28</td>
      <td>473.457916</td>
      <td>-598.481119</td>
      <td>None</td>
      <td>-598.481119</td>
      <td>00:16</td>
    </tr>
    <tr>
      <td>29</td>
      <td>453.391968</td>
      <td>-562.297491</td>
      <td>None</td>
      <td>-562.297491</td>
      <td>00:16</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

