---

title: DADS


keywords: fastai
sidebar: home_sidebar

summary: "Diversity Is All You Need"
description: "Diversity Is All You Need"
nb_path: "nbs/14c_actorcritic.dads.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/14c_actorcritic.dads.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_LAUNCH_BLOCKING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GMM">GMM<a class="anchor-link" href="#GMM"> </a></h2><blockquote><p>A neural net with a gaussian probability distribution component.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gaussian Mixture Models parameterized by neural nets can be used for:</p>
<ul>
<li>Giving the probability that a given <code>state</code> + <code>action</code> will result in <code>next_state</code></li>
<li>Predict what the <code>next_state</code> will look like given a <code>state</code> + <code>action</code></li>
</ul>
<p>Hopefully from the list above, it is understandable <em>why</em> a GMM can be useful.
Since it has a probabilistic component, you can avoid instances of (easily) overfitting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OptionalClampLinear" class="doc_header"><code>class</code> <code>OptionalClampLinear</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L38" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OptionalClampLinear</code>(<strong><code>num_inputs</code></strong>, <strong><code>state_dims</code></strong>, <strong><code>fix_variance</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>clip_min</code></strong>=<em><code>0.3</code></em>, <strong><code>clip_max</code></strong>=<em><code>10.0</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCompGMM" class="doc_header"><code>class</code> <code>MultiCompGMM</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCompGMM</code>(<strong><code>num_inputs</code></strong>, <strong><code>state_dims</code></strong>, <strong><code>n_components</code></strong>, <strong><code>fix_variance</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SimpleGMM" class="doc_header"><code>class</code> <code>SimpleGMM</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L69" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SimpleGMM</code>(<strong><code>num_inputs</code></strong>, <strong><code>state_dims</code></strong>, <strong><code>fix_variance</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GMM" class="doc_header"><code>class</code> <code>GMM</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L78" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GMM</code>(<strong><code>num_inputs</code></strong>, <strong><code>state_dims</code></strong>, <strong><code>n_components</code></strong>, <strong><code>fix_variance</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The GMM is going to try to predict the next state. So lets make a simple input to optimize against.
This test will be of a hot airballoon. Lets see if we can have a reasonable next state prediction.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hot_air_ballon_start_states</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">hot_air_ballon_start_actions</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mf">0.5</span>
<span class="n">hot_air_ballon_next_states</span><span class="o">=</span><span class="n">hot_air_ballon_start_states</span><span class="o">+</span><span class="n">hot_air_ballon_start_actions</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Starting Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_start_actions</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Action&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_next_states</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Resulting Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gmm</span><span class="o">=</span><span class="n">GMM</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">fix_variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">opt</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">gmm</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, lets see if the GMM can predict the next state accurately...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">])</span>
<span class="n">dist</span><span class="o">=</span><span class="n">gmm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">hot_air_ballon_start_states</span><span class="o">+</span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.2004],
        [ 0.0395],
        [-0.0499],
        [-0.3426],
        [-0.1009]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
versus...
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.8766],
        [ 0.6072],
        [ 0.5631],
        [-0.1309],
        [ 0.3064]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yeah the GMM is way off...
So lets first see if we can get it to optimize to predict a next state...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">next_timesteps</span><span class="o">=</span><span class="n">hot_air_ballon_next_states</span><span class="o">-</span><span class="n">hot_air_ballon_start_states</span>    
<span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">])</span>

<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">dist</span><span class="o">=</span><span class="n">gmm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">=-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">next_timesteps</span><span class="p">))</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">step</span><span class="o">%</span><span class="k">1000</span>==0:print(loss,torch.mean(dist.log_prob(next_timesteps)))
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(0.7990, grad_fn=&lt;NegBackward&gt;) tensor(-0.7990, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.1519, grad_fn=&lt;NegBackward&gt;) tensor(0.1519, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2826, grad_fn=&lt;NegBackward&gt;) tensor(0.2826, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">])</span>
<span class="n">dist</span><span class="o">=</span><span class="n">gmm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">hot_air_ballon_start_states</span><span class="o">+</span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.8787],
        [ 0.6466],
        [ 0.6556],
        [-0.0577],
        [ 0.3492]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.8766],
        [ 0.6072],
        [ 0.5631],
        [-0.1309],
        [ 0.3064]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is much better, the GMM is making a better prediction of what the next state is going to be...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Skill-Dynamics">Skill Dynamics<a class="anchor-link" href="#Skill-Dynamics"> </a></h2><blockquote><p>Now that we have a working GMM, we need a way to modify our input data to be useful for the DADS agent.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SkillDynamics" class="doc_header"><code>class</code> <code>SkillDynamics</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L88" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SkillDynamics</code>(<strong><code>s_dim</code></strong>, <strong><code>a_dim</code></strong>, <strong><code>n_components</code></strong>, <strong><code>fix_variance</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>use_model_mean</code></strong>:<code>bool</code>=<em><code>None</code></em>, <strong><code>use_batch_norm</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>fc_params</code></strong>:<code>tuple</code>=<em><code>None</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#SkillDynamics"><code>SkillDynamics</code></a> module is actually pretty simple. It is tasked with getting the mean and log probability from the <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#GMM"><code>GMM</code></a> and providing a convenient way to get a predicted state. It additionaly has the capability of batch normalization, noise, and input shuffling.</p>
<p>Going back to our hot air balloon example, lets feed the states, actions, and resulting states into it...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skill_dyn</span><span class="o">=</span><span class="n">SkillDynamics</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">fix_variance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">use_batch_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">opt</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">skill_dyn</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skill_dyn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SkillDynamics(
  (fcs): Sequential(
    (0): Linear(in_features=2, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=256, bias=True)
  )
  (gmm): GMM(
    (distribution): MultiCompGMM(
      (logit_fc): Linear(in_features=256, out_features=2, bias=True)
      (mean_fcs): ModuleList(
        (0): Linear(in_features=256, out_features=1, bias=True)
        (1): Linear(in_features=256, out_features=1, bias=True)
      )
      (std_fcs): ModuleList(
        (0): OptionalClampLinear(
          (fc): Linear(in_features=256, out_features=1, bias=True)
        )
        (1): OptionalClampLinear(
          (fc): Linear(in_features=256, out_features=1, bias=True)
        )
      )
    )
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets do a regular feed through and look at the output of our <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#SkillDynamics"><code>SkillDynamics</code></a> instance.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skill_dyn</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">,</span>
                           <span class="n">hot_air_ballon_next_states</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(MixtureSameFamily(
   Categorical(probs: torch.Size([5, 2]), logits: torch.Size([5, 2])),
   Independent(Normal(loc: torch.Size([5, 2, 1]), scale: torch.Size([5, 2, 1])), 1)),
 tensor([-0.3687, -0.4014, -0.6694, -0.8048, -0.6627],
        grad_fn=&lt;LogsumexpBackward&gt;))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have 3 components: <code>dist</code>, <code>mean</code>, and <code>log_prob</code>.\
<code>dist</code> lets the user do more advanced operations with the results.\
<code>mean</code> will always return since at minimum <code>s</code> and <code>a</code> need to be passed in.\
<code>log_prob</code> can be returned if <code>sp</code> is not None.</p>
<p>The most immediately useful result is <code>log_prob</code> since it can be used for operations that need to know <em>what is the probability of this state occuring.</em></p>
<p>However, like we said earlier, <code>dist</code> is returned because we might want to do more advanced operations. For example <code>predict_state</code>...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[ 1.0413],
         [ 0.7837],
         [-0.0335],
         [ 0.4576],
         [ 0.7973]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[ 0.8766],
         [ 0.6072],
         [ 0.5631],
         [-0.1309],
         [ 0.3064]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This state prediction seems terrible! Obviously, we need to train <code>skill_dyn</code> so this is more accurate. You may notice the number of steps is 100 as opposed to 5000! This is because we are actually feeding a linear layer's output into the <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#GMM"><code>GMM</code></a> as opposed to the <code>s+a</code> tensor directly. This is called a <code>latent space</code>, and these have friendlier values for the <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#GMM"><code>GMM</code></a> to learn against. You will also see later that the results are a little more accurate also.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">print_every</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">skill_dyn</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span><span class="n">log_prob</span><span class="o">=</span><span class="n">skill_dyn</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">,</span>
                       <span class="n">hot_air_ballon_next_states</span><span class="p">)</span>

        <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">=-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">log_prob</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">step</span><span class="o">%</span><span class="k">print_every</span>==0:print(loss,torch.mean(dist.log_prob(next_timesteps)))
        <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">skill_dyn</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">train</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(0.5814, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2565, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2833, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2846, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[ 0.8766],
         [ 0.6069],
         [ 0.5640],
         [-0.1334],
         [ 0.3046]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[ 0.8766],
         [ 0.6072],
         [ 0.5631],
         [-0.1309],
         [ 0.3064]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much better! It is ok they are not exact, we want <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#SkillDynamics"><code>SkillDynamics</code></a> to have a general idea on how current states and their actions can cause the state to change.</p>
<p>But here is a small wrench in the works. You will notice that the state spaces we are feeding into the model have values [-1, 1] which are nice and friendly to train our model on but also <strong>highly unrealistic in the real world</strong>. We will likely see values [-10,1000] possibly. Can we train on these? Let's convert our ballon problem into meters. We don't need to worry about actions because the values of actions are usually <em>within our control</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hot_air_ballon_start_states</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">hot_air_ballon_start_actions</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mf">0.5</span>
<span class="n">hot_air_ballon_next_states</span><span class="o">=</span><span class="n">hot_air_ballon_start_states</span><span class="o">+</span><span class="n">hot_air_ballon_start_actions</span><span class="o">*</span><span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Starting Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_start_actions</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Action&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hot_air_ballon_next_states</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Resulting Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are much bigger values... Training a model on these without normalzing can be very hard. 
The worst part is that in order to normalize something like states,
you would need to know <em>what is the absolute minimum and maximum this state will ever be</em>. This is a general problem in RL because when the agent is first
starting the states might start small, such as being newer the origin 0,0, but everntually as the agent gets better it starts to get to states like -20,100.
Our model needs to convert these into nice [0,1] or [-1,1] values.</p>
<p>So first, lets see if we can even learn anything without batch norm...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skill_dyn</span><span class="o">=</span><span class="n">SkillDynamics</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">fix_variance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">use_batch_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">opt</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">skill_dyn</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
<span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[82.5656],
         [97.2659],
         [67.0467],
         [30.5847],
         [61.1488]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[114.8931],
         [102.6087],
         [ 99.4525],
         [-16.3825],
         [  4.4237]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(8254.2676, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(1128.5951, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(1111.5380, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(1094.3474, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(1073.3273, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(1047.8489, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[104.2251],
         [121.4682],
         [ 85.2475],
         [ 38.4907],
         [ 75.6049]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[114.8931],
         [102.6087],
         [ 99.4525],
         [-16.3825],
         [  4.4237]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hm... It's diffinitely not amazing. The worst part is that this will likely be made worst with larger and differing batches. Lets see if using batch norm makes this better...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skill_dyn</span><span class="o">=</span><span class="n">SkillDynamics</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">fix_variance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">use_batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opt</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">skill_dyn</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
<span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[64.1265],
         [75.5676],
         [52.0900],
         [23.9268],
         [47.6465]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[114.8931],
         [102.6087],
         [ 99.4525],
         [-16.3825],
         [  4.4237]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(1.9198, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2652, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2848, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
tensor(-0.2850, grad_fn=&lt;NegBackward&gt;) tensor(0.2850, grad_fn=&lt;MeanBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;Prediction:&#39;</span><span class="p">,</span>\
<span class="n">skill_dyn</span><span class="o">.</span><span class="n">predict_state</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="n">hot_air_ballon_start_actions</span><span class="p">),</span>\
<span class="s1">&#39;Actual&#39;</span><span class="p">,</span>\
<span class="n">hot_air_ballon_next_states</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;Prediction:&#39;,
 tensor([[120.8537],
         [107.3076],
         [103.7468],
         [-21.1855],
         [ -0.9865]], grad_fn=&lt;AddBackward0&gt;),
 &#39;Actual&#39;,
 tensor([[114.8931],
         [102.6087],
         [ 99.4525],
         [-16.3825],
         [  4.4237]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great! It seems that batch norm makes <a href="/fast-reinforcement-learning-2/actorcritic.dads.html#SkillDynamics"><code>SkillDynamics</code></a> compatible with state space inputs of varying values 
that will addapt as the agent explores its environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DADS-Agent">DADS Agent<a class="anchor-link" href="#DADS-Agent"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Marginalization-methods">Marginalization methods<a class="anchor-link" href="#Marginalization-methods"> </a></h3><blockquote><p>Ways of calculating the denominator.</p>
</blockquote>
<p>A good reference is <a href="https://towardsdatascience.com/probability-concepts-explained-marginalisation-2296846344fc">Probability concepts explained:Marginalisation</a>. We need to calculate the intrinsic reward whose primary goal is to say:- Did this skill produce predictable results? If so, let's reward it for doing so!</p>
<p>The actual math from the <a href="https://arxiv.org/abs/1907.01657">Dynamics-Aware Unsupervised Discovery of Skills</a> for intrinsic reward:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$r_z(s,a,s')=\log{\frac{q_{\phi}(s' \mid s,z)}{\sum_{i=1}^L q_{\phi}(s' \mid s,z_i)}}+\log{L},~~ z_i \sim p(z)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Agent">Agent<a class="anchor-link" href="#Agent"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DADS" class="doc_header"><code>class</code> <code>DADS</code><a href="https://github.com/josiahls/fast-reinforcement-learning-2/tree/master/fastrl/actorcritic/dads.py#L138" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DADS</code>(<strong><code>num_inputs</code></strong>, <strong><code>action_space</code></strong>, <strong><code>num_skills</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>include_actions</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>hidden_size</code></strong>=<em><code>100</code></em>, <strong><code>lr</code></strong>=<em><code>0.003</code></em>, <strong><code>n_components</code></strong>:<code>int</code>=<em><code>4</code></em>, <strong><code>prior_samples</code></strong>:<code>int</code>=<em><code>100</code></em>, <strong><code>latent_sz</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>gamma</code></strong>=<em><code>0.99</code></em>, <strong><code>tau</code></strong>=<em><code>0.005</code></em>, <strong><code>alpha</code></strong>=<em><code>0.2</code></em>, <strong><code>policy</code></strong>=<em><code>'gaussian'</code></em>, <strong><code>automatic_entropy_tuning</code></strong>=<em><code>True</code></em>, <strong><code>target_update_interval</code></strong>=<em><code>1</code></em>) :: <a href="/fast-reinforcement-learning-2/actorcritic.sac.html#SAC"><code>SAC</code></a></p>
</blockquote>
<p>BaseAgent(model: torch.nn.modules.module.Module = None)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cur_skill</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">cur_skill</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]]),
 array([[0, 0, 0, 0, 0, 0, 1]]),
 array([[1, 0, 0, 0, 0, 0, 0]]),
 array([[0, 1, 0, 0, 0, 0, 0]]),
 array([[0, 0, 1, 0, 0, 0, 0]]),
 array([[0, 0, 0, 1, 0, 0, 0]]),
 array([[0, 0, 0, 0, 1, 0, 0]]),
 array([[0, 0, 0, 0, 0, 1, 0]])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dads</span><span class="o">=</span><span class="n">DADS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">1</span><span class="p">,)));</span><span class="n">dads</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-117-77a653754187&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>dads<span class="ansi-blue-fg">=</span>DADS<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>gym<span class="ansi-blue-fg">.</span>spaces<span class="ansi-blue-fg">.</span>Box<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>dads

<span class="ansi-green-fg">&lt;ipython-input-114-00e1d09cff81&gt;</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, num_inputs, action_space, num_skills, include_actions, hidden_size, lr, n_components, prior_samples, latent_sz, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>         self<span class="ansi-blue-fg">.</span>original_num_inputs<span class="ansi-blue-fg">=</span>num_inputs
<span class="ansi-green-intense-fg ansi-bold">      9</span>         self<span class="ansi-blue-fg">.</span>skill_dyn<span class="ansi-blue-fg">=</span>SkillDynamics<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>num_inputs<span class="ansi-blue-fg">,</span>action_space<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>n_components<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 10</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>num_inputs<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>latent_sz<span class="ansi-blue-fg">,</span>hidden_size<span class="ansi-blue-fg">=</span>hidden_size<span class="ansi-blue-fg">,</span>lr<span class="ansi-blue-fg">=</span>lr<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> 
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-green-fg">def</span> intrinsic_reward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>s<span class="ansi-blue-fg">,</span>z<span class="ansi-blue-fg">:</span>int<span class="ansi-blue-fg">,</span>sp<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/project/fastrl/fastrl/actorcritic/sac.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, num_inputs, action_space, gamma, tau, alpha, policy, automatic_entropy_tuning, target_update_interval, hidden_size, lr)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> 
<span class="ansi-green-intense-fg ansi-bold">    240</span>         <span class="ansi-red-fg"># qf</span>
<span class="ansi-green-fg">--&gt; 241</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>critic <span class="ansi-blue-fg">=</span> QNetwork<span class="ansi-blue-fg">(</span>num_inputs<span class="ansi-blue-fg">,</span> action_space<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> hidden_size<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>to<span class="ansi-blue-fg">(</span>device<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    242</span>         self<span class="ansi-blue-fg">.</span>critic_optim <span class="ansi-blue-fg">=</span> Adam<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>critic<span class="ansi-blue-fg">.</span>parameters<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> lr<span class="ansi-blue-fg">=</span>lr<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> 

<span class="ansi-red-fg">AttributeError</span>: &#39;int&#39; object has no attribute &#39;shape&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dads</span><span class="o">.</span><span class="n">intrinsic_reward</span><span class="p">(</span><span class="n">hot_air_ballon_start_states</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">hot_air_ballon_next_states</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-118-5de0db600b44&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>dads<span class="ansi-blue-fg">.</span>intrinsic_reward<span class="ansi-blue-fg">(</span>hot_air_ballon_start_states<span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>hot_air_ballon_next_states<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> 

<span class="ansi-red-fg">AttributeError</span>: &#39;DADS&#39; object has no attribute &#39;intrinsic_reward&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Full-Training">Full Training<a class="anchor-link" href="#Full-Training"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># class Discriminator(Module):</span>
<span class="c1">#     &quot;`Module` for storing skills. Receives input (`num_inputs`+`num_actions`) -&gt; `num_skills`.&quot;</span>
<span class="c1">#     def __init__(self, num_inputs,num_actions,num_skills,hidden_dim):</span>
<span class="c1">#         self.linear1 = nn.Linear(num_inputs+num_skills, hidden_dim)</span>
<span class="c1">#         self.linear2 = nn.Linear(hidden_dim, hidden_dim)</span>
<span class="c1">#         self.linear3 = nn.Linear(hidden_dim,num_skills)</span>

<span class="c1">#         self.apply(weights_init_)</span>

<span class="c1">#     def forward(self, state):</span>
<span class="c1">#         x = F.relu(self.linear1(state.float()))</span>
<span class="c1">#         x = F.relu(self.linear2(x))</span>
<span class="c1">#         return self.linear3(x)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># @delegates(SAC)</span>
<span class="c1"># class DADS(SAC):</span>
<span class="c1">#     def __init__(self,num_inputs,action_space,discriminator:Module=None,num_skills:int=20,</span>
<span class="c1">#                  find_best_skill_interval:int=10,scale_entropy:float=1,</span>
<span class="c1">#                  best_skill_n_rollouts:int=10,include_actions:bool=False,</span>
<span class="c1">#                  learn_p_z:bool=False,add_p_z:bool=True,hidden_size=100,lr=0.003,**kwargs):</span>
<span class="c1">#         store_attr()</span>
<span class="c1">#         self.num_inputs=num_inputs+self.num_skills</span>
<span class="c1">#         self.original_num_inputs=num_inputs</span>
<span class="c1">#         self.p_z=np.full(self.num_skills,1.0/self.num_skills)</span>
<span class="c1">#         self.discriminator=Discriminator(self.original_num_inputs,action_space.shape[0],</span>
<span class="c1">#                                          num_skills,hidden_size)</span>

<span class="c1">#         self.discriminator_optim = Adam(self.discriminator.parameters(), lr=self.lr)</span>

<span class="c1">#         self.log_p_z_episode=[]</span>
<span class="c1">#         self.z=0</span>
<span class="c1">#         self.reset_z()</span>


<span class="c1">#         super().__init__(self.num_inputs,action_space,hidden_size=hidden_size,lr=lr,**kwargs)</span>

<span class="c1">#     def sample_z(self):</span>
<span class="c1">#         &quot;&quot;&quot;Samples z from p(z), using probabilities in self._p_z.&quot;&quot;&quot;</span>
<span class="c1">#         return np.random.choice(self.num_skills,p=self.p_z)</span>

<span class="c1">#     def reset_z(self): self.z=self.sample_z()</span>
<span class="c1">#     def __call__(self,s,asl):</span>
<span class="c1">#         aug_s=self.concat_obs_z(s,self.z)</span>
<span class="c1">#         return super().__call__(aug_s,asl)</span>

<span class="c1">#     def concat_obs_z(self,obs,z):</span>
<span class="c1">#         &quot;&quot;&quot;Concatenates the observation to a one-hot encoding of Z.&quot;&quot;&quot;</span>
<span class="c1">#         assert np.isscalar(z)</span>
<span class="c1">#         if type(obs)==list and len(obs)==1: obs=obs[0]</span>
<span class="c1">#         if len(obs.shape)==2 and obs.shape[0]==1: obs=obs[0]</span>

<span class="c1">#         z_one_hot=np.zeros(self.num_skills)</span>
<span class="c1">#         z_one_hot[z]=1</span>
<span class="c1">#         if type(obs)==Tensor: obs=obs.cpu()</span>
<span class="c1">#         return torch.FloatTensor(np.hstack([obs,z_one_hot])).reshape(1,-1)</span>

<span class="c1">#     def skill_p(self,skill,next_state):</span>
<span class="c1">#         unnorm_skill_dist=self.discriminator(next_state).unsqueeze(0)</span>
<span class="c1">#         skill_p=F.softmax(unnorm_skill_dist)[:,skill]</span>
<span class="c1">#         return skill_p,unnorm_skill_dist</span>

<span class="c1">#     def discriminator_learn(self,skill,out):</span>
<span class="c1">#         self.discriminator_optim.zero_grad()</span>
<span class="c1">#         loss=nn.CrossEntropyLoss()(out,torch.LongTensor([skill]))</span>
<span class="c1">#         loss.backward()</span>
<span class="c1">#         self.discriminator_optim.step()</span>

<span class="c1">#     def intrinsic_reward(self,next_state):</span>
<span class="c1">#         skill_p,disc_out=self.skill_p(self.z,next_state)</span>
<span class="c1">#         intrinsic_reward=np.log(skill_p.cpu().detach()+1e-8)-np.log(self.p_z[self.z])</span>
<span class="c1"># #         print(skill_p,self.p_z,intrinsic_reward)</span>
<span class="c1">#         return intrinsic_reward,disc_out</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># class DiscriminatorTrainer(ExperienceReplay):</span>

<span class="c1">#     def __init__(self,*args,**kwargs):</span>
<span class="c1">#         self.log_p_z_episode=[]</span>
<span class="c1">#         super().__init__(*args,**kwargs)</span>
        
<span class="c1">#     def before_fit(self):</span>
<span class="c1">#         self.learn.agent.warming_up=True</span>
<span class="c1">#         while len(self.queue)&lt;self.starting_els:</span>
<span class="c1">#             for i,o in enumerate(self.dls.train):</span>
<span class="c1">#                 z=self.learn.agent.z</span>
<span class="c1">#                 batch=[ExperienceFirstLast(state=self.learn.agent.concat_obs_z(o[0][i],z)[0],</span>
<span class="c1">#                                            action=o[1][i],</span>
<span class="c1">#                                            reward=o[2][i],</span>
<span class="c1">#                                            last_state=self.learn.agent.concat_obs_z(o[3][i],z)[0], </span>
<span class="c1">#                                            done=(o[4][i] and self.max_steps!=o[6][i]),</span>
<span class="c1">#                                            episode_reward=o[5][i],steps=o[6][i])</span>
<span class="c1">#                                     for i in range(len(o[0]))]</span>
<span class="c1"># #                 print(self.max_steps,max([o.steps for o in batch]))</span>
<span class="c1"># #                 print(batch[0])</span>
<span class="c1">#                 for k in range(len(batch)):</span>
<span class="c1">#                     intrinsic_reward,disc_out=self.learn.agent.intrinsic_reward(Tensor(batch[k].last_state))</span>
<span class="c1">#                     self.learn.agent.discriminator_learn(self.agent.z,disc_out)</span>
<span class="c1">#                     batch[k]=ExperienceFirstLast(</span>
<span class="c1">#                         state=batch[k].state.to(device=default_device()),</span>
<span class="c1">#                         action=batch[k].action,</span>
<span class="c1">#                         reward=intrinsic_reward,</span>
<span class="c1">#                         last_state=batch[k].last_state.to(device=default_device()),</span>
<span class="c1">#                         done=batch[k].done,</span>
<span class="c1">#                         episode_reward=batch[k].episode_reward,</span>
<span class="c1">#                         steps=batch[k].steps</span>
<span class="c1">#                     )</span>


<span class="c1"># #                 print(batch[0])</span>
<span class="c1">#                 for _b in batch:self.queue.append(_b)</span>
<span class="c1">#                 if any([_b.done for _b in batch]): self.learn.agent.reset_z()</span>
<span class="c1">#                 if len(self.queue)&gt;self.starting_els:break</span>
<span class="c1">#         self.learn.agent.warming_up=False</span>

<span class="c1"># # #     def after_epoch(self):</span>
<span class="c1"># # #         print(len(self.queue))</span>
<span class="c1">#     def before_batch(self):</span>
<span class="c1"># #         print(len(self.queue))</span>
<span class="c1">#         b=list(self.learn.xb)+list(self.learn.yb)</span>
<span class="c1">#         z=self.learn.agent.z</span>
<span class="c1">#         batch=[ExperienceFirstLast(state=self.learn.agent.concat_obs_z(b[0][i],z)[0],</span>
<span class="c1">#                                    action=b[1][i],</span>
<span class="c1">#                                    reward=b[2][i],</span>
<span class="c1">#                                    last_state=self.learn.agent.concat_obs_z(b[3][i],z)[0], </span>
<span class="c1">#                                    done=(b[4][i] and self.max_steps!=b[6][i]),</span>
<span class="c1">#                                    episode_reward=b[5][i],steps=b[6][i])</span>
<span class="c1">#               for i in range(len(b[0]))]</span>
        
<span class="c1">#         for k in range(len(batch)):</span>
<span class="c1">#             intrinsic_reward,disc_out=self.learn.agent.intrinsic_reward(Tensor(batch[k].last_state))</span>
<span class="c1">#             self.learn.agent.discriminator_learn(self.agent.z,disc_out)</span>
<span class="c1">#             batch[k]=ExperienceFirstLast(</span>
<span class="c1">#                 state=batch[k].state.to(device=default_device()),</span>
<span class="c1">#                 action=batch[k].action,</span>
<span class="c1">#                 reward=intrinsic_reward,</span>
<span class="c1">#                 last_state=batch[k].last_state.to(device=default_device()),</span>
<span class="c1">#                 done=batch[k].done,</span>
<span class="c1">#                 episode_reward=batch[k].episode_reward,</span>
<span class="c1">#                 steps=batch[k].steps</span>
<span class="c1">#             )</span>
        
<span class="c1"># #         print(self.learn.xb)</span>
<span class="c1">#         self.learn.xb=(torch.stack([e.state for e in batch]),)</span>
<span class="c1"># #         print(self.learn.yb)</span>
<span class="c1">#         self.learn.yb=(torch.stack([o.action for o in batch]),</span>
<span class="c1">#                        torch.stack([o.reward for o in batch]),</span>
<span class="c1">#                        torch.stack([o.last_state for o in batch]),</span>
<span class="c1">#                        torch.stack([o.done for o in batch]),</span>
<span class="c1">#                        torch.stack([o.episode_reward for o in batch]),</span>
<span class="c1">#                        torch.stack([o.steps for o in batch]))</span>
<span class="c1"># #         print(self.learn.yb)</span>
        
<span class="c1">#         for _b in batch: self.queue.append(_b)</span>
<span class="c1">#         idxs=np.random.randint(0,len(self.queue), self.bs)</span>
<span class="c1">#         self.learn.sample_yb=[self.queue[i] for i in idxs]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># env=&#39;InvertedPendulumPyBulletEnv-v0&#39;</span>
<span class="c1"># agent=DADS(5,gym.make(env).action_space,gamma=0.99,tau=0.005,alpha=0.1,hidden_size=300,num_skills=5)</span>
<span class="c1"># block=FirstLastExperienceBlock(agent=agent,seed=0,n_steps=2,exclude_nones=True,</span>
<span class="c1">#                                dls_kwargs={&#39;bs&#39;:1,&#39;num_workers&#39;:0,&#39;verbose&#39;:False,&#39;indexed&#39;:True,&#39;shuffle_train&#39;:False})</span>
<span class="c1"># blk=IterableDataBlock(blocks=(block),splitter=FuncSplitter(lambda x:False))</span>
<span class="c1"># dls=blk.dataloaders([env]*1,n=10,device=default_device())</span>

<span class="c1"># learner=SACLearner(dls,agent=agent,cbs=[DiscriminatorTrainer(sz=1000000,bs=64,starting_els=1000,max_steps=gym.make(env)._max_episode_steps),</span>
<span class="c1">#                                         SACCriticTrainer],</span>
<span class="c1">#                    metrics=[AvgEpisodeRewardMetric(experience_cls=ExperienceFirstLast)])</span>
<span class="c1"># learner.fit(1,lr=0.003,wd=0)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># # slow</span>
<span class="c1"># import gym</span>
<span class="c1"># from IPython import display</span>
<span class="c1"># import PIL.Image</span>
<span class="c1"># %matplotlib inline</span>

<span class="c1"># # env=gym.make(&#39;InvertedPendulumPyBulletEnv-v0&#39;)</span>
<span class="c1"># # s=env.reset()</span>

<span class="c1"># # for z in range(5):</span>
<span class="c1"># #     for i in range(0,100,20):</span>
<span class="c1"># #         s=env.reset()</span>
<span class="c1"># #         env.seed(i)</span>
<span class="c1"># #         for _ in range(200):</span>
<span class="c1"># #             display.clear_output(wait=True)</span>
<span class="c1"># #             display.display(PIL.Image.fromarray(env.render(mode=&#39;rgb_array&#39;)))</span>

<span class="c1"># #             agent.z=z</span>
<span class="c1"># #             a,_=agent(s,None)</span>

<span class="c1"># #             s,r,d,_=env.step(a)</span>
<span class="c1"># #             if d:</span>
<span class="c1"># #                 break</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

